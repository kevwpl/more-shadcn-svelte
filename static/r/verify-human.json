{
	"$schema": "https://shadcn-svelte.com/schema/registry-item.json",
	"name": "verify-human",
	"title": "Hold Button",
	"type": "registry:ui",
	"description": "A self-contained heuristic bot protection component. It uses honeypots, velocity checks, and event trust analysis.",
	"dependencies": [
		"lucide-svelte@^0.554.0"
	],
	"files": [
		{
			"content": "<script lang=\"ts\">\n\timport { cn } from '$UTILS$';\n\timport { Check, Loader2, ShieldCheck, X } from 'lucide-svelte';\n\timport { onMount } from 'svelte';\n\n\tlet {\n\t\tclass: className,\n\t\tonVerify,\n\t\tverified = $bindable(false)\n\t}: {\n\t\tclass?: string;\n\t\tonVerify?: () => void;\n\t\tverified?: boolean;\n\t} = $props();\n\n\tlet status = $state<'idle' | 'verifying' | 'verified' | 'failed'>('idle');\n\tlet mountTime = 0;\n\tlet humanInteraction = false;\n\tlet honeypot = $state(false);\n\n\tonMount(() => {\n\t\tmountTime = Date.now();\n\n\t\tconst markHuman = () => {\n\t\t\thumanInteraction = true;\n\t\t};\n\t\twindow.addEventListener('mousemove', markHuman, { once: true });\n\t\twindow.addEventListener('touchstart', markHuman, { once: true });\n\t\twindow.addEventListener('keydown', markHuman, { once: true });\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener('mousemove', markHuman);\n\t\t\twindow.removeEventListener('touchstart', markHuman);\n\t\t\twindow.removeEventListener('keydown', markHuman);\n\t\t};\n\t});\n\n\tfunction runHeuristics(e: MouseEvent | TouchEvent | KeyboardEvent) {\n\t\tif (honeypot) return false;\n\n\t\tif (Date.now() - mountTime < 500) return false;\n\n\t\tif (!humanInteraction) return false;\n\n\t\tif (!e.isTrusted) return false;\n\n\t\treturn true;\n\t}\n\n\tasync function handleClick(e: any) {\n\t\tif (status !== 'idle' && status !== 'failed') return;\n\n\t\tstatus = 'verifying';\n\n\t\tawait new Promise((r) => setTimeout(r, 800));\n\n\t\tif (runHeuristics(e)) {\n\t\t\tstatus = 'verified';\n\t\t\tverified = true;\n\t\t\tonVerify?.();\n\t\t} else {\n\t\t\tstatus = 'failed';\n\t\t\tverified = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tstatus = 'idle';\n\t\t\t}, 2000);\n\t\t}\n\t}\n</script>\n\n<input\n\ttype=\"checkbox\"\n\tclass=\"absolute opacity-0 -z-10 w-0 h-0\"\n\ttabindex=\"-1\"\n\tbind:checked={honeypot}\n\tautocomplete=\"off\"\n/>\n\n<button\n\tonclick={handleClick}\n\tclass={cn(\n\t\t'group flex items-center justify-between w-[300px] h-16 px-4 rounded-md border bg-card text-card-foreground shadow-sm transition-all select-none',\n\t\tstatus === 'idle' && 'hover:bg-accent/5 cursor-pointer',\n\t\tstatus === 'failed' && 'border-red-500/50 bg-red-500/5 cursor-not-allowed',\n\t\t(status === 'verifying' || status === 'verified') && 'cursor-default',\n\t\tclassName\n\t)}\n\ttype=\"button\"\n>\n\t<div class=\"flex items-center gap-3\">\n\t\t<div\n\t\t\tclass={cn(\n\t\t\t\t'relative flex items-center justify-center w-7 h-7 rounded border-2 bg-background transition-all duration-300',\n\t\t\t\tstatus === 'idle' && 'border-muted-foreground/30 group-hover:border-muted-foreground/50',\n\t\t\t\tstatus === 'verifying' && 'border-transparent',\n\t\t\t\tstatus === 'verified' && 'border-primary bg-primary',\n\t\t\t\tstatus === 'failed' && 'border-destructive'\n\t\t\t)}\n\t\t>\n\t\t\t{#if status === 'verifying'}\n\t\t\t\t<Loader2 class=\"h-8 w-8 text-primary animate-spin absolute\" />\n\t\t\t{/if}\n\n\t\t\t{#if status === 'verified'}\n\t\t\t\t<Check\n\t\t\t\t\tclass=\"h-4 w-4 text-primary-foreground animate-in zoom-in duration-300\"\n\t\t\t\t\tstrokeWidth={3}\n\t\t\t\t/>\n\t\t\t{/if}\n\n\t\t\t{#if status === 'failed'}\n\t\t\t\t<X class=\"h-4 w-4 text-destructive animate-in zoom-in duration-300\" strokeWidth={3} />\n\t\t\t{/if}\n\t\t</div>\n\n\t\t<div class=\"flex flex-col items-start\">\n\t\t\t<span class=\"text-sm font-medium leading-none\">\n\t\t\t\t{#if status === 'verified'}\n\t\t\t\t\tI am human\n\t\t\t\t{:else if status === 'failed'}\n\t\t\t\t\tVerification failed\n\t\t\t\t{:else if status === 'verifying'}\n\t\t\t\t\tVerifying...\n\t\t\t\t{:else}\n\t\t\t\t\tVerify you are human\n\t\t\t\t{/if}\n\t\t\t</span>\n\t\t\t{#if status === 'failed'}\n\t\t\t\t<span class=\"text-[10px] text-destructive mt-1\">Please try again</span>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n\n\t<div class=\"flex flex-col items-center justify-center gap-0.5 opacity-50\">\n\t\t<ShieldCheck class=\"h-6 w-6 text-muted-foreground\" />\n\t\t<span class=\"text-[9px] text-muted-foreground leading-none\">Secure</span>\n\t</div>\n</button>\n",
			"type": "registry:ui",
			"target": "verify-human/verify-human.svelte"
		},
		{
			"content": "import VerifyHuman from './verify-human.svelte';\nexport { VerifyHuman };\n",
			"type": "registry:ui",
			"target": "verify-human/index.ts"
		}
	]
}