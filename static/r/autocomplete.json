{
	"$schema": "https://shadcn-svelte.com/schema/registry-item.json",
	"name": "autocomplete",
	"title": "Autocomplete",
	"type": "registry:ui",
	"description": "An input component with autocomplete suggestions.",
	"dependencies": [
		"@lucide/svelte@^0.554.0"
	],
	"devDependencies": [
		"@lucide/svelte@^0.544.0"
	],
	"registryDependencies": [
		"input"
	],
	"files": [
		{
			"content": "<script lang=\"ts\" generics=\"T\">\n\timport { Input } from '$lib/components/ui/input';\n\timport { cn } from '$UTILS$';\n\timport { Loader2, Search, X } from '@lucide/svelte';\n\timport { fly } from 'svelte/transition';\n\timport type { Snippet } from 'svelte';\n\n\tlet {\n\t\tvalue = $bindable(''),\n\t\tselected = $bindable<T | null>(null),\n\t\toptions = [],\n\t\tloading = false,\n\t\tplaceholder = 'Search...',\n\t\tlabelKey,\n\t\tclass: className,\n\t\tonSelect,\n\t\titemSnippet,\n\t\temptySnippet,\n\t\t...rest\n\t}: {\n\t\tvalue: string;\n\t\tselected?: T | null;\n\t\toptions: T[];\n\t\tloading?: boolean;\n\t\tplaceholder?: string;\n\t\tlabelKey?: keyof T;\n\t\tclass?: string;\n\t\tonSelect?: (item: T) => void;\n\t\titemSnippet: Snippet<[T, boolean]>;\n\t\temptySnippet?: Snippet;\n\t\t[key: string]: any;\n\t} = $props();\n\n\tlet isOpen = $state(false);\n\tlet activeIndex = $state(-1);\n\n\tlet inputContainerRef = $state<HTMLDivElement | null>(null);\n\tlet listRef = $state<HTMLDivElement | null>(null);\n\n\tfunction open() {\n\t\tisOpen = true;\n\t\tactiveIndex = -1;\n\t}\n\n\tfunction close() {\n\t\tisOpen = false;\n\t\tactiveIndex = -1;\n\t}\n\n\tfunction handleInput(e: Event) {\n\t\tvalue = (e.target as HTMLInputElement).value;\n\t\tif (value.length > 0) open();\n\t\telse close();\n\t}\n\n\tfunction handleSelect(item: T) {\n\t\tselected = item;\n\n\t\tif (labelKey && item && typeof item === 'object') {\n\t\t\tvalue = String(item[labelKey]);\n\t\t} else if (typeof item === 'string') {\n\t\t\tvalue = item;\n\t\t}\n\n\t\tif (onSelect) onSelect(item);\n\t\tclose();\n\t}\n\n\tfunction handleKeydown(e: KeyboardEvent) {\n\t\tif (!isOpen) {\n\t\t\tif (e.key === 'ArrowDown' && value.length > 0) open();\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (e.key) {\n\t\t\tcase 'ArrowDown':\n\t\t\t\te.preventDefault();\n\t\t\t\tactiveIndex = (activeIndex + 1) % options.length;\n\t\t\t\tscrollToActive();\n\t\t\t\tbreak;\n\t\t\tcase 'ArrowUp':\n\t\t\t\te.preventDefault();\n\t\t\t\tactiveIndex = (activeIndex - 1 + options.length) % options.length;\n\t\t\t\tscrollToActive();\n\t\t\t\tbreak;\n\t\t\tcase 'Enter':\n\t\t\t\te.preventDefault();\n\t\t\t\tif (activeIndex >= 0 && options[activeIndex]) {\n\t\t\t\t\thandleSelect(options[activeIndex]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Escape':\n\t\t\t\tclose();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tfunction scrollToActive() {\n\t\tif (!listRef) return;\n\t\tconst activeEl = listRef.children[activeIndex] as HTMLElement;\n\t\tif (activeEl) {\n\t\t\tactiveEl.scrollIntoView({ block: 'nearest' });\n\t\t}\n\t}\n\n\tfunction clickOutside(node: HTMLElement) {\n\t\tconst handleClick = (event: MouseEvent) => {\n\t\t\tconst target = event.target as Node;\n\t\t\tif (\n\t\t\t\tnode &&\n\t\t\t\t!node.contains(target) &&\n\t\t\t\tinputContainerRef &&\n\t\t\t\t!inputContainerRef.contains(target)\n\t\t\t) {\n\t\t\t\tclose();\n\t\t\t}\n\t\t};\n\t\tdocument.addEventListener('click', handleClick, true);\n\t\treturn {\n\t\t\tdestroy() {\n\t\t\t\tdocument.removeEventListener('click', handleClick, true);\n\t\t\t}\n\t\t};\n\t}\n</script>\n\n<div class={cn('relative w-full group', className)}>\n\t<div class=\"relative\" bind:this={inputContainerRef}>\n\t\t<Input\n\t\t\ttype=\"text\"\n\t\t\t{placeholder}\n\t\t\tbind:value\n\t\t\toninput={handleInput}\n\t\t\tonkeydown={handleKeydown}\n\t\t\tonfocus={() => {\n\t\t\t\tif (value) open();\n\t\t\t}}\n\t\t\trole=\"combobox\"\n\t\t\taria-expanded={isOpen}\n\t\t\taria-autocomplete=\"list\"\n\t\t\t{...rest}\n\t\t/>\n\n\t\t{#if loading}\n\t\t\t<Loader2\n\t\t\t\tclass=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 animate-spin text-muted-foreground\"\n\t\t\t/>\n\t\t{:else if value.length > 0}\n\t\t\t<button\n\t\t\t\tclass=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground\"\n\t\t\t\tonclick={() => {\n\t\t\t\t\tvalue = '';\n\t\t\t\t\tselected = null;\n\t\t\t\t\tinputContainerRef?.querySelector('input')?.focus();\n\t\t\t\t\tclose();\n\t\t\t\t}}\n\t\t\t\taria-label=\"Clear\"\n\t\t\t>\n\t\t\t\t<X class=\"h-4 w-4\" />\n\t\t\t</button>\n\t\t{:else}\n\t\t\t<Search\n\t\t\t\tclass=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none\"\n\t\t\t/>\n\t\t{/if}\n\t</div>\n\n\t{#if isOpen}\n\t\t<div\n\t\t\tuse:clickOutside\n\t\t\tbind:this={listRef}\n\t\t\tclass=\"absolute z-50 mt-2 w-full max-h-[300px] overflow-y-auto rounded-md border bg-popover p-1 text-popover-foreground shadow-md outline-none\"\n\t\t\ttransition:fly={{ y: -5, duration: 150 }}\n\t\t>\n\t\t\t{#if options.length > 0}\n\t\t\t\t{#each options as option, i}\n\t\t\t\t\t<div\n\t\t\t\t\t\trole=\"option\"\n\t\t\t\t\t\ttabindex=\"-1\"\n\t\t\t\t\t\taria-selected={i === activeIndex}\n\t\t\t\t\t\tclass={cn(\n\t\t\t\t\t\t\t'relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors',\n\t\t\t\t\t\t\ti === activeIndex\n\t\t\t\t\t\t\t\t? 'bg-accent text-accent-foreground'\n\t\t\t\t\t\t\t\t: 'hover:bg-accent hover:text-accent-foreground'\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tonclick={() => handleSelect(option)}\n\t\t\t\t\t\tonmouseenter={() => (activeIndex = i)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{@render itemSnippet(option, i === activeIndex)}\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\t\t\t{:else if !loading}\n\t\t\t\t<div class=\"py-6 text-center text-sm text-muted-foreground\">\n\t\t\t\t\t{#if emptySnippet}\n\t\t\t\t\t\t{@render emptySnippet()}\n\t\t\t\t\t{:else}\n\t\t\t\t\t\tNo results found.\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t{/if}\n</div>\n",
			"type": "registry:ui",
			"target": "autocomplete/autocomplete.svelte"
		},
		{
			"content": "<script lang=\"ts\">\n    let { text, query, class: className }: { text: string, query: string, class?: string } = $props();\n\n    let parts = $derived.by(() => {\n        if (!query) return [{ text, highlight: false }];\n        const regex = new RegExp(`(${query})`, 'gi');\n        return text.split(regex).map(part => ({\n            text: part,\n            highlight: part.toLowerCase() === query.toLowerCase()\n        }));\n    });\n</script>\n\n<span class={className}>\n    {#each parts as part}\n        {#if part.highlight}\n            <span class=\"bg-yellow-200 dark:bg-yellow-900/50 font-semibold text-foreground\">{part.text}</span>\n        {:else}\n            {part.text}\n        {/if}\n    {/each}\n</span>",
			"type": "registry:ui",
			"target": "autocomplete/autocomplete-highlight.svelte"
		},
		{
			"content": "import Root from \"./autocomplete.svelte\";\nimport Highlight from './autocomplete-highlight.svelte'\n\nexport {\n    Root,\n    Highlight\n};",
			"type": "registry:ui",
			"target": "autocomplete/index.ts"
		}
	]
}