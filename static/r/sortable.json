{
	"$schema": "https://shadcn-svelte.com/schema/registry-item.json",
	"name": "sortable",
	"title": "Sortable",
	"type": "registry:ui",
	"description": "A sortable list for vertical, horizontal, and grid layouts.",
	"dependencies": [
		"lucide-svelte@^0.554.0"
	],
	"files": [
		{
			"content": "<script lang=\"ts\">\n\timport { cn } from '$UTILS$';\n\timport { setSortableContext } from './ctx';\n\timport { tick, type Snippet } from 'svelte';\n\n\tlet {\n\t\titems = $bindable([]),\n\t\tclass: className,\n\t\tchildren,\n\t\tonSort,\n\t\tanimation = 200\n\t}: {\n\t\titems: any[];\n\t\tclass?: string;\n\t\tchildren: Snippet;\n\t\tonSort?: (items: any[]) => void;\n\t\tanimation?: number;\n\t} = $props();\n\n\tlet draggedId = $state<string | null>(null);\n\tlet itemNodes = new Map<string, HTMLElement>();\n\n\tasync function move(fromIdx: number, toIdx: number) {\n\t\tconst rects = new Map<string, DOMRect>();\n\t\titemNodes.forEach((node, id) => rects.set(id, node.getBoundingClientRect()));\n\n\t\tconst newItems = [...items];\n\t\tconst [item] = newItems.splice(fromIdx, 1);\n\t\tnewItems.splice(toIdx, 0, item);\n\t\titems = newItems;\n\t\tonSort?.(newItems);\n\n\t\tawait tick();\n\n\t\titemNodes.forEach((node, id) => {\n\t\t\tconst prev = rects.get(id);\n\t\t\tif (!prev) return;\n\t\t\tconst curr = node.getBoundingClientRect();\n\t\t\tconst dx = prev.left - curr.left;\n\t\t\tconst dy = prev.top - curr.top;\n\t\t\tif (dx || dy) {\n\t\t\t\tnode.style.transition = 'none';\n\t\t\t\tnode.style.transform = `translate(${dx}px, ${dy}px)`;\n\t\t\t\tnode.offsetHeight;\n\t\t\t\tnode.style.transition = `transform ${animation}ms cubic-bezier(0.2, 0, 0, 1)`;\n\t\t\t\tnode.style.transform = '';\n\t\t\t}\n\t\t});\n\t}\n\n\tsetSortableContext({\n\t\tgetDraggedId: () => draggedId,\n\t\tregisterItem: (id, node) => itemNodes.set(id, node),\n\t\tunregisterItem: (id) => itemNodes.delete(id),\n\t\tonDragStart: (e, id) => {\n\t\t\tdraggedId = id;\n\t\t\tif (e.dataTransfer) {\n\t\t\t\te.dataTransfer.effectAllowed = 'move';\n\t\t\t\tconst ghost = document.createElement('div');\n\t\t\t\te.dataTransfer.setDragImage(ghost, 0, 0);\n\t\t\t}\n\t\t},\n\t\tonDragOver: (e, targetId) => {\n\t\t\te.preventDefault();\n\t\t\tif (!draggedId || draggedId === targetId) return;\n\n\t\t\tconst fromIdx = items.findIndex((i) => i.id === draggedId);\n\t\t\tconst toIdx = items.findIndex((i) => i.id === targetId);\n\n\t\t\tif (fromIdx !== -1 && toIdx !== -1) {\n\t\t\t\tmove(fromIdx, toIdx);\n\t\t\t}\n\t\t},\n\t\tonDragEnd: () => {\n\t\t\tdraggedId = null;\n\t\t}\n\t});\n</script>\n\n<div class={cn(className)}>\n\t{@render children()}\n</div>\n",
			"type": "registry:ui",
			"target": "sortable/sortable.svelte"
		},
		{
			"content": "<script lang=\"ts\">\n\timport { cn } from '$UTILS$';\n\timport { getSortableContext } from './ctx';\n\timport { onMount, onDestroy, type Snippet } from 'svelte';\n\n\tlet {\n\t\tid,\n\t\tclass: className,\n\t\tchildren\n\t}: { id: string; class?: string; children: Snippet } = $props();\n\n\tconst ctx = getSortableContext();\n\tlet node = $state<HTMLElement>();\n\n\tonMount(() => {\n\t\tif (node) ctx.registerItem(id, node);\n\t});\n\tonDestroy(() => ctx.unregisterItem(id));\n\n\tlet isDragging = $derived(ctx?.getDraggedId() === id);\n</script>\n\n<div\n\tbind:this={node}\n\tclass={cn('relative transition-all', isDragging && 'opacity-30', className)}\n\tdraggable=\"false\"\n\tondragstart={(e) => ctx.onDragStart(e, id)}\n\tondragover={(e) => ctx.onDragOver(e, id)}\n\tondragend={(e) => ctx.onDragEnd(e)}\n>\n\t{@render children()}\n</div>\n",
			"type": "registry:ui",
			"target": "sortable/sortable-item.svelte"
		},
		{
			"content": "<script lang=\"ts\">\n\timport { cn } from '$UTILS$';\n\timport { GripVertical } from 'lucide-svelte';\n\timport type { Snippet } from 'svelte';\n\n\tlet { class: className, children }: { class?: string; children?: Snippet } = $props();\n\n\tfunction setDraggable(e: MouseEvent, state: boolean) {\n\t\tconst target = e.currentTarget as HTMLElement;\n\t\tconst item =\n\t\t\ttarget.closest('div[draggable=\"false\"]') || target.closest('div[draggable=\"true\"]');\n\t\tif (item instanceof HTMLElement) {\n\t\t\titem.draggable = state;\n\t\t}\n\t}\n</script>\n\n<div\n\tclass={cn('cursor-grab active:cursor-grabbing p-1 touch-none', className)}\n\tonmousedown={(e) => setDraggable(e, true)}\n\tonmouseup={(e) => setDraggable(e, false)}\n\tonmouseleave={(e) => setDraggable(e, false)}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{:else}\n\t\t<GripVertical class=\"size-4 opacity-50\" />\n\t{/if}\n</div>\n",
			"type": "registry:ui",
			"target": "sortable/sortable-handle.svelte"
		},
		{
			"content": "import { getContext, setContext } from 'svelte';\n\nconst SORTABLE_KEY = Symbol('sortable');\n\nexport type SortableContext = {\n\tonDragStart: (e: DragEvent, id: string) => void;\n\tonDragOver: (e: DragEvent, id: string) => void;\n\tonDragEnd: (e: DragEvent) => void;\n\tregisterItem: (id: string, node: HTMLElement) => void;\n\tunregisterItem: (id: string) => void;\n\tgetDraggedId: () => string | null;\n};\n\nexport function setSortableContext(props: SortableContext) {\n\tsetContext(SORTABLE_KEY, props);\n}\n\nexport function getSortableContext() {\n\treturn getContext<SortableContext>(SORTABLE_KEY);\n}\n",
			"type": "registry:ui",
			"target": "sortable/ctx.ts"
		},
		{
			"content": "import Sortable from './sortable.svelte';\nimport SortableItem from './sortable-item.svelte';\nimport SortableHandle from './sortable-handle.svelte';\n\nexport { Sortable as Root, SortableItem as Item, SortableHandle as Handle };\n",
			"type": "registry:ui",
			"target": "sortable/index.ts"
		}
	]
}